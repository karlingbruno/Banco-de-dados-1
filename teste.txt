CREATE OR REPLACE FUNCTION process_emp_audit() RETURNS TRIGGER
AS $$
 BEGIN
 IF (TG_OP = 'DELETE') THEN
 INSERT INTO  auditoria values (OLD.id,OLD.cpf,OLD.Num_Departamento,OLD.Salario,OLD.Supervisor,3,current_user,now());
 RETURN OLD;
 ELSIF (TG_OP = 'UPDATE') THEN
  INSERT INTO  auditoria values (NEW.id,NEW.cpf,NEW.Num_Departamento,NEW.Salario,NEW.Supervisor,2,current_user,now());
 RETURN NEW;
 ELSIF (TG_OP = 'INSERT') THEN
  INSERT INTO  auditoria values (NEW.id,NEW.cpf,NEW.Num_Departamento,NEW.Salario,NEW.Supervisor,1,current_user,now());
 RETURN NEW;
 END IF;
 RETURN NULL;
 END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER emp
AFTER INSERT OR UPDATE OR DELETE ON empregado
 FOR EACH ROW EXECUTE PROCEDURE process_emp_audit();

 Auditoria(empregado_ID int, cpf CHAR(12), Num_Departamento integer,
 Salario DECIMAL(10,2 ), Supervisor varchar(50) , evento int, usuario varchar,
 date date);

EMPREGADO( id integer primary key, nome varchar(50), cpf varchar(15),
Num_Departamento integer, Salario DECIMAL(10,2 ), Supervisor
varchar(50));
